{namespace collection}

/**
 * Main search form
 * @param question Search Question
 * @param? response Search Response
 * @param? error Search Error
 */
{template .search}
<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="utf-8" />
	<meta name="robots" content="nofollow" />
	<link rel="stylesheet" media="screen" href="css/search.css" type="text/css" />
	
	
	
	<title>Funnelback Search</title>

	<style type="text/css">
		li.even h3 {lb}
			border: solid 2px #dddddd;
	{rb}
	</style>

</head>

<body>

    {$question} {$error}	
    {if not $response}
	<!-- NO QUERY SPECIFIED -->
	<div id="fb-initial">
		<a href="http://funnelback.com/"><img src="img/funnelback.png" alt="Funnelback logo"></a>
	</div>
    {/if}
	
	<!-- SEARCH LOGO -->
	<div><a id="fb-logo" {if not $response}class="fb-initial"{/if} href="http://funnelback.com/"><img	src="img/funnelback-small.png" alt="Funnelback logo" width="170" height="36"></a></div>
	
	<!-- QUERY FORM -->
	
	<div id="fb-queryform" {if not $response}class="fb-initial"{/if}>
		<form method="GET">
			<div>
				<label for="query" style="text-indent: -9999em;">Search</label>
				<input name="query" id="query" type="text" value="{$question.query}" accesskey="q" />
				<input type="submit" value="Search" />
			
				<input type="hidden" name="collection" value="shakespeare-lear" />
				<input type="hidden" name="profile" value="_default" />
			</div>
		</form>
	</div>

    {if $response}
        {if $response.resultPacket}
		
			<p id="fb-matching">
				<span id="fb-utils">
					<a href="#" id="fb-advanced-toggle">Advanced search</a>
					<span id="fb-help">| <a href="/search/help/simple_search.html">Help</a></span>
				</span>
		
                {if $response.resultPacket.resultsSummary.totalMatching > 0}
    				<span class="fb-result-count" id="fb-page-start">{$response.resultPacket.resultsSummary.currStar}</span> -{sp}
	    			<span class="fb-result-count" id="fb-page-end">{$response.resultPacket.resultsSummary.currEnd}</span> of{sp}
		    		<span class="fb-result-count" id="fb-total-matching">{$response.resultPacket.resultsSummary.totalMatching}</span>{sp}
		    		search results{sp} 
                {else}
			        <span class="fb-result-count" id="fb-total-matching">0</span> search results{sp}
                {/if}

                for <strong>{$response.resultPacket.query}</strong>
                
                {if $response.resultPacket.resultsSummary.partiallyMatching > 0}
			        {sp}where{sp}
            		<span class="fb-result-count" id="fb-fully-matching">
			          	{$response.resultPacket.resultsSummary.fullyMatching}
			        </span>
			        {sp}match all words and{sp}
			        <span class="fb-result-count" id="fb-partially-matching">
			          	{$response.resultPacket.resultsSummary.partiallyMatching}
			        </span>
			        {sp}match some words.{sp}
                {/if}
			</p>		
			
			<div id="fb-wrapper">
			
					<!-- RESULTS SUMMARY -->
					<div id="fb-summary">
	
                        {if $response.resultPacket.spell}
							<!-- Did you mean...? -->
							<span id="fb-spelling">
								Did you mean <a href="{$response.resultPacket.spell.url}">{$response.resultPacket.spell.text}</a> ?
							</span>
                        {/if}
		
						<!-- TIER BARS -->
					</div>
					
					<!-- FEATURED PAGES (BEST BETS) -->
					{lb}.repeated section bestBet{rb}
						<div class="fb-best-bet">
							{lb}.section titl{rb}<h3><a href="{lb}lin{rb}">{lb}title|boldiciz{rb}</a></h3>{lb}.en{rb}
							{lb}.section descriptio{rb}<p>{lb}description|boldiciz{rb}</p>{lb}.en{rb}
							{lb}.section lin{rb}<p><cite>{lb}lin{rb}</cite></p>{lb}.en{rb}
							{lb}.section titl{rb}{lb}.o{rb}<p><strong>{lb}trigge{rb}:</strong> <a href="{lb}lin{rb}">{lb}lin{rb}</a>{lb}.en{rb}
						</div>
					{lb}.en{rb}
	
					<!-- RESULTS -->
					<ol id="fb-results">
					
                        {foreach $result in $response.resultPacket.results}
						{lb}.repeated section result{rb}
							<!-- EACH RESULT -->
							<li class="result">
								<h3>
                                    {if $result.fileType != 'html'}
										<span class="fb-filetype fb-{$result.fileType}">[{$result.fileType}]&nbsp;</span>
                                    {/if}
									<a href="{lb}displayUr{rb}" title="{lb}liveUr{rb}">{$result.title}</a>
								</h3>
					
								{lb}.section fileTyp{rb}
									{lb}.eq.pdf{rb}<p class="fb-file-format"><span>{lb}fileSize|filesiz{rb} - PDF</span>
									<a class="fb-cached" href="{lb}cacheUr{rb}" title="View '{lb}titl{rb}' as HTML">View as HTML</a></p>{lb}.en{rb}
									{lb}.eq.doc{rb}<p class="fb-file-format"><span>{lb}fileSize|filesiz{rb} - Microsoft Word</span>
									<a class="fb-cached" href="{lb}cacheUr{rb}" title="View '{lb}titl{rb}' as HTML">View as HTML</a></p>{lb}.en{rb}
									{lb}.eq.xls{rb}<p class="fb-file-format"><span>{lb}fileSize|filesiz{rb} - Microsoft Excel</span>
									<a class="fb-cached" href="{lb}cacheUr{rb}" title="View '{lb}titl{rb}' as HTML">View as HTML</a></p>{lb}.en{rb}
									{lb}.eq.ppt{rb}<p class="fb-file-format"><span>{lb}fileSize|filesiz{rb} - Microsoft Powerpoint</span>
									<a class="fb-cached" href="{lb}cacheUr{rb}" title="View '{lb}titl{rb}' as HTML">View as HTML</a></p>{lb}.en{rb}
								{lb}.en{rb}
								
								<!-- QUERY BIASED SUMMARY (WITH DATE)-->
								<p>
									<span class="fb-date">{lb}date|dat{rb}</span>
									<span class="fb-summary">{lb}summar{rb}</span>
								</p>
					
								<!-- METADATA SUMMARIES -->
								{lb}.section metaDat{rb}
									{lb}.section {rb}<p>{lb}{rb}</p>{lb}.en{rb}
									{lb}.section {rb}<span class="fb-meta author"><span>by </span> {lb}{rb}</span>{lb}.en{rb}
									{lb}.section {rb}<span class="fb-meta keywords"><span>Keywords:</span> {lb}{rb}</span>{lb}.en{rb}
									{lb}.section {rb}<span class="fb-meta publisher"><span>Publisher:</span> {lb}{rb}</span>{lb}.en{rb}
								{lb}.en{rb}
					
								<!-- URL AND FILESIZE -->
								<p>
									<cite>{lb}liveUrl|cut.http://|trunc.7{rb}</cite>
									{lb}.section fileTyp{rb}
										{lb}.regexp.^(?!(pdf|doc|xls|ppt)){rb}
											- <a class="fb-cached" href="{lb}cacheUr{rb}" title="Cached version of {lb}titl{rb}">Cached</a>
										{lb}.en{rb}
									{lb}.en{rb}
									
									<!-- EXPLORE LINKS -->
									<a class="fb-explore" href="?collection={lb}collectio{rb}&amp;query=explore:{lb}liveUr{rb}">Explore</a>
								</p>
					
					
								<!-- QUICKLINKS -->
							</li>
                        {ifempty}
								<!-- NO RESULTS -->
								<li id="fb-no-results">Your search for <strong></strong> did not return any results. <span>Please ensure that you:</span>
									<ul>
										<li>are not using any advanced search operators like + - | " etc.</li> 
										<li>expect this document to exist within the collection <em>{lb}details.collectionSiz{rb}</em></li>
										<li>have permission to see any documents that may match your query</li>
									</ul>
								</li>
                        {/foreach}
						
                        {call funnelback.search.prevNext data="all" /}

						{lb}.section resultsSummar{rb}
							<p class="fb-page-nav">
								{lb}.section prevLin{rb}
									[ <a href="{lb}{rb}" class="fb-previous-result-page fb-page-nav">Prev {lb}numRank{rb}</a> ]
								{lb}.en{rb}

								{lb}.repeated section pageLink{rb}
									{lb}@inde{rb}
									{lb}.section curren{rb}
										<span class=\"fb-current-result-page\">{lb}pag{rb}</span>
									{lb}.o{rb}
										<a href="{lb}lin{rb}">{lb}pag{rb}</a>
									{lb}.en{rb}
								{lb}.en{rb}

								{lb}.section nextLin{rb}
									[ <a href="{lb}{rb}" class="fb-next-result-page fb-page-nav">Next {lb}numRank{rb}</a> ]
								{lb}.en{rb}
							</p>
						{lb}.en{rb}
					
					</ol> 
			</div>
        {/if}
    {/if} 
</body>
</html>
{/template}
