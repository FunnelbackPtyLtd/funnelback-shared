!function(t){"use strict";function e(t){return(e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}var a=function(t,e){var a;try{a=moment(t,"YYYY-MM-DD kk:mm").format(e)}catch(e){a=t}return a},l=function(t){var e=moment(t).year,a=moment().year();return e>a+1||e<a-1?e:moment(t).fromNow()},n="Funnelback Knowledge Graph",o={log:function(t,e,a){this.factory("log",t,e,a)},warn:function(t,e,a){this.factory("warn",t,e,a)},factory:function(t,e,a,l){console.group(n),console[t](e||"",a||"",l||""),console.groupEnd()}},i={data:{},clear:function(){i.data={}},getItem:function(t){var e=i.data[t];if(e&&e.list&&!$.isObject(e.list[0]))for(var a=0,l=e.list.length;a<l;a++)e.list[a]=i.getItem("kgnodes"+e.list[a]).list[0];return e},isItem:function(t){return i.data[t]&&null!==i.data[t]},removeItem:function(t){delete i.data[t]},setItem:function(t,e){i.data[t]=e}},r={get:function(t,e,a){return r.getBaseBasedOnPath(a,t)+t+(e?"?"+$.param(e):"")},getBaseBasedOnPath:function(t,e){return t?"/"===e.charAt(0)?t.slice(0,-1):t:""},getPathParams:function(t){for(var e,a=t,l=a.substring(a.indexOf("?")+1),n=/([^&=]+)=?([^&]*)/g,o={};e=n.exec(l);)o[e[1].decodeUriParam()]=e[2].decodeUriParam();return o},getPathParts:function(t,e,a){var l=r.path(t,e).split("?")[0].split("/")||[];return a&&l[a]?l[a]:l},getUrl:function(t){return t.split("?")[0]},isAbsoluteUrl:function(t){var e=/^(?:[a-zA-Z]+:\/\/)?/.exec(t);return!(!e.length||!e[0].length)},isNodeDetail:function(t){return!!t.match(/\/nodes\/[0-9]+/g)},path:function(t,e){return e?t.slice(e.length):t},setBase:function(t){return t?t.endsWithIndexOf("/")?t:t+"/":""},setUrl:function(t,e,a){return t?r.get(t,a,r.isAbsoluteUrl(t)?null:e):t},storageKey:function(t,e){var a=r.getPathParams(t);return l("collection"),l("profile"),r.getPathParts(t,e).join("")+Object.keys(a).map((function(t){return t+a[t]})).join("");function l(t){delete a[t]}}},s={currentLang:window.navigator.languages?window.navigator.languages[0]:window.navigator.language,defaultLang:"en",storageKey:"translations",urlPath:"s/knowledge-graph/labels.json",keys:{default:"_default",property:"property",relationship:"relationship",type:"type"},configure:function(t){var e=r.get(this.urlPath,{collection:t.options.collection,profile:t.options.profile},t.options.apiBase);return T.get(t,e).then((function(t){i.setItem(s.storageKey,t.data)})).catch((function(t){T.error(t,!0)}))},get:function(){if(arguments.length){var t,e=[].slice.call(arguments),a=i.getItem(this.storageKey);if(a&&(t=a[e[0]]&&(a[e[0]][e[1]]||a[e[0]][s.keys.default])||void 0,e[0]===s.keys.property&&t)){for(;$.isString(t)&&a[e[0]][t];)t=a[e[0]][t];$.isObject(t)&&(t=t[e[2]])}return t||e[e.length-1].capitalize()}}},c=function(t){return Handlebars.compile(t)},f=function(t){$.map(t,(function(t,e){return Handlebars.registerPartial(e+"-block",t)}))};Handlebars.registerHelper({badgeType:function(t){return t.toLowerCase().replace(/ /g,"-")},dateFormat:function(t,e){return a(e.fn(this),t)},imageDefaultType:function(t){var e=t.data.root._options.imageDefault[this._type];return e?("ICON"===e.type?"icon":"image")+"-block":""},imageDefaultContext:function(t){var e=t.data.root._options.imageDefault[this._type];return e?"ICON"===e.type?{_icon:e.value}:{_image:e.value}:""},item:function(t){var e="list"===t.data.root._options.field.display&&this.val.length>1?"listText":"text";return u.isBadgeField(this.key)&&(e="badge"),u.isDateField(this.key)&&(e="date"),u.isEmailField(this.val)&&(e="email"),u.isPathField(this.key)&&(e="path"),u.isPhoneField(this.key)&&(e="phone"),e+"-block"},isUrl:function(t){return!$.isDefined(t.data.root._options.viewUrl[this._type])||t.data.root._options.viewUrl[this._type]},translate:function(){var t,e=[].slice.call(arguments),a=e.length,l=[];for(t=0;t<a;t++)$.isString(e[t])&&l.push(e[t]);return s.get.apply(s,l)},eq:function(t,e){return t===e},ne:function(t,e){return t!==e},lt:function(t,e){return t<e},gt:function(t,e){return t>e},lte:function(t,e){return t<=e},gte:function(t,e){return t>=e},and:function(){return Array.prototype.slice.call(arguments).every(Boolean)},or:function(){return Array.prototype.slice.call(arguments,0,-1).some(Boolean)},not:function(t){return!t}});var d={notpartial:{alert:'<div class="'.concat("flb-","alert ").concat("flb-",'alert-{{type}}" role="alert"> {{#if status}}<h5>Error code: <b>{{status}}</b></h5>{{/if}}{{{msg}}} </div>'),back:'{{> breadcrumbItem-block _nav="back" _title="Go back one page" _icon="fa fa-fw fa-arrow-left"}}',badge:'{{> breadcrumbItem-block _nav="back" _title="Go back one page" _icon="fa fa-fw fa-arrow-left"}}',breadcrumb:'{{#each list}} {{#if @index}} {{#if _sub}} <div class="'.concat("flb-","nav-item ").concat("flb-",'dropdown"> <a class="').concat("flb-","nav-link ").concat("flb-",'dropdown-toggle" href="#" id="navbarDropdownMenuLink" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false"> ... </a> <div class="').concat("flb-","dropdown-menu ").concat("flb-",'bg-dark" aria-labelledby="navbarDropdownMenuLink"> {{#each _sub}}{{> breadcrumbItem-block _nav="breadcrumb" _label=_label _title=_label _url=_idx _classes="').concat("flb-",'dropdown-item"}}{{/each}} </div> </div> {{else}} {{> breadcrumbItem-block _nav="breadcrumb" _label=_label _title=_label _url=_idx}} {{/if}} {{else}} {{> breadcrumbItem-block _nav="breadcrumb" _label=_label _title="Go to first page" _url=_idx _icon="fa fa-fw fa-home"}} {{/if}} {{/each}}'),detail:'<div class="'.concat("flb-","card-body ").concat("flb-","d-flex ").concat("flb-",'flex-column kg-content" data-kg-url="{{_url.self}}"> <div class="').concat("flb-",'d-block"> <span class="').concat("flb-","d-inline-flex ").concat("flb-","mb-2 ").concat("flb-","align-items-center ").concat("flb-",'text-info kg-detail-type">{{>icon-block}}{{translate @root._translate.type _type}}</span> {{>img-block _classes="').concat("flb-","float-right ").concat("flb-",'card-image-lg"}} <h4 class="kg-title ').concat("flb-",'card-title">{{{_title}}}</h4> <h5 class="kg-subtitle ').concat("flb-","card-subtitle ").concat("flb-",'text-info">{{{_subtitle}}}</h5>{{> primary-block _classes="').concat("flb-","mt-3 ").concat("flb-",'mb-4"}} <hr> {{#if secondary}} <table class="kg-secondary-table ').concat("flb-","table ").concat("flb-","table-backgroundless ").concat("flb-","table-borderless ").concat("flb-",'table-sm"> {{#each secondary}} <tr> <th class="').concat("flb-","text-info ").concat("flb-",'font-weight-bold" scope="row">{{translate @root._translate.property ../_type key}}</th> <td>{{> (item)}}</td> </tr> {{/each}} </table> {{/if}} {{#if _desc}}<p class="').concat("flb-",'mb-4">{{_desc}}</p>{{/if}} </div> <div class="').concat("flb-",'mt-auto"> {{>url-block _classes="').concat("flb-","btn ").concat("flb-","btn-block ").concat("flb-",'btn-dark" _label="View" _icon="fa fa-fw fa-external-link fa-external-link-alt"}} {{>phone-block _classes="').concat("flb-","btn ").concat("flb-","btn-block ").concat("flb-",'btn-dark" _label="Call now" _icon="icon-Phone"}} {{#if _shareUrl}}<a class="').concat("flb-","btn ").concat("flb-","btn-block ").concat("flb-",'btn-dark" href="#" data-kg-nav="share" data-kg-url="{{_shareUrl}}" title="Click to copy link to the clickboard">Share</a>{{/if}} </div> </div>'),facets:'{{#each this as |facet facetId|}} <div class="'.concat("flb-","card ").concat("flb-","my-2 ").concat("flb-","border-0 ").concat("flb-",'bg-transparent"> <div class="').concat("flb-","card-header ").concat("flb-","bg-transparent ").concat("flb-","border-bottom ").concat("flb-","py-2 ").concat("flb-",'px-3"> {{facet.name}} {{#if facet._url}} <a href="" data-kg-nav="facet" data-kg-url="{{facet._url}}"> <small class="').concat("flb-",'pl-1">{{facet._label}}</small> </a> {{/if}} </div> <div> <div class="').concat("flb-","card-body ").concat("flb-","py-0 ").concat("flb-",'px-3"> <ul class="').concat("flb-","list-unstyled ").concat("flb-","list-link ").concat("flb-",'mb-0"> {{#each facet.allValues as |category|}} <li class="').concat("flb-","my-1 {{#if (gte @index 8)}}").concat("flb-",'collapse collapsedFacet{{facetId}}{{/if}}"> <a class="{{#if category.selected}}').concat("flb-","active{{/if}} ").concat("flb-",'text-secondary" href="#" data-kg-nav="facet" data-kg-url="{{category._url}}"> {{#if (and category.selected (eq facet.guessedDisplayType "SINGLE_DRILL_DOWN") (ne @index 0))}}&#8627;{{/if}} {{category.label}}{{#unless category.selected}}<span class="').concat("flb-","float-right ").concat("flb-",'font-weight-bold">{{category.count}}</span>{{/unless}} </a> </li> {{/each}} {{#if (gt facet.allValues.length 9)}} <li> <a class="').concat("flb-",'collapsed" data-kg-nav="collapse" data-toggle="collapse" data-target="collapsedFacet{{facetId}}" href="#" role="button" aria-expanded="false"> <span class="fa fa-fw fa-chevron-up"></span> </a> </li> {{/if}} </ul> </div> </div> </div> {{/each}}'),list:"{{>list-block}}",listHeader:'<h3 class="'.concat("flb-","font-weight-bold ").concat("flb-",'text-success">{{title}}</h3> <p class="').concat("flb-",'text-truncate">{{desc}}</p>'),paginationItem:'<span class="'.concat("flb-","page-item{{#if _isActive}} ").concat("flb-",'active{{/if}}"> <a class="').concat("flb-",'page-link" href="#" data-kg-nav="page" data-kg-url="{{_url}}">{{_label}}</a> </span>'),searchHeader:"Showing results <strong>{{_start}}</strong>-<strong>{{_end}}</strong> of <strong>{{_total}}</strong> for <em>{{_query}}</em>",tab:"{{#each this}}{{>tabItem-block}}{{/each}}",tabList:'<div class="'.concat("flb-",'tab-pane" id="{{_id}}" role="tabpanel" aria-labelledby="{{_id}}-tab"> {{>list-block}} </div>'),type:"{{#each this}}{{>typeItem-block}}{{/each}}"},onceRender:{layout:'<nav class="'.concat("flb-","navbar ").concat("flb-","sticky-top ").concat("flb-","navbar-expand-sm ").concat("flb-","navbar-dark ").concat("flb-",'bg-dark"> <a class="').concat("flb-",'navbar-brand"> <img src="{{options.apiBase}}s/resources-global/images/funnelback_logo.png"> <span>Knowledge graph</span> </a> <a class="').concat("flb-","navbar-toggler ").concat("flb-","collapsed ").concat("flb-",'ml-auto" href="#navbarNav" data-kg-nav="collapse" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation"> <span class="fa fa-fw fa-bars"></span> </a> <div class="').concat("flb-","collapse ").concat("flb-",'navbar-collapse" id="navbarNav"> <div class="').concat("flb-","navbar-nav ").concat("flb-",'font-weight-light"> <div class="kg-back"></div> <div class="kg-breadcrumb"></div> </div> <form class="kg-searchBox ').concat("flb-","form-inline ").concat("flb-",'ml-auto"> <div class="').concat("flb-",'input-group"> <input type="search" class="').concat("flb-","form-control ").concat("flb-","border-0 ").concat("flb-","bg-dark ").concat("flb-",'text-white" placeholder="Discover with KnowledgeGraph" aria-describedby="button-search"> <div class="').concat("flb-",'input-group-append"> <button class="').concat("flb-","btn ").concat("flb-",'btn-dark" type="button" data-kg-nav="search"><span class="fa fa-fw fa-search"></span></button> </div> </div> </form> </div> <a class="').concat("flb-","btn ").concat("flb-",'btn-close" data-kg-nav="close" aria-label="Close"> <span aria-hidden="true">&times;</span> </a> </nav> <main class="').concat("flb-",'container-fluid"> <div class="').concat("flb-",'row kg-viewGraph"> <div class="kg-detailWrapper ').concat("flb-","col-12 ").concat("flb-","col-sm-5 ").concat("flb-","col-md-5 ").concat("flb-","col-lg-5 ").concat("flb-",'pr-0"> <div class="').concat("flb-","row ").concat("flb-",'no-gutters"> <div class="').concat("flb-","col-12 ").concat("flb-","col-sm-9 ").concat("flb-","col-md-8 ").concat("flb-","col-lg-9 ").concat("flb-","modal-scroll ").concat("flb-","bg-success ").concat("flb-",'text-white"> <section class="kg-detail ').concat("flb-","card ").concat("flb-","h-100 ").concat("flb-","border-0 ").concat("flb-","rounded-0 ").concat("flb-",'bg-transparent"></section> </div> <div class="').concat("flb-","col-12 ").concat("flb-","col-sm-3 ").concat("flb-","col-md-4 ").concat("flb-","col-lg-3 ").concat("flb-","modal-scroll ").concat("flb-",'bg-white"> <div class="kg-types ').concat("flb-","list-group ").concat("flb-","list-group-horizontal-xs ").concat("flb-",'list-group-flush"></div> </div> </div> </div> <div class="kg-listWrapper ').concat("flb-","col-12 ").concat("flb-","col-sm-7 ").concat("flb-","col-md-7 ").concat("flb-",'col-lg-7"> <section class="kg-header ').concat("flb-","mt-3 ").concat("flb-",'mb-4"></section> <section class="kg-tabsWrapper ').concat("flb-","border-bottom ").concat("flb-",'mb-3"> <div class="').concat("flb-",'nav-scroller"> <a class="').concat("flb-","scroller-nav ").concat("flb-","scroller-left kg-scrollerLeft ").concat("flb-","btn ").concat("flb-","py-0 ").concat("flb-",'px-2"> <span class="fa fa-fw fa-chevron-left"></span> </a> <a class="').concat("flb-","scroller-nav ").concat("flb-","scroller-right kg-scrollerRight ").concat("flb-","btn ").concat("flb-","py-0 ").concat("flb-",'px-2"> <span class="fa fa-fw fa-chevron-right"></span> </a> <div class="').concat("flb-",'scroller-wrapper kg-scroller"> <div class="kg-tabs ').concat("flb-","nav ").concat("flb-",'nav-underscore" role="tablist"></div> </div> </div> </section> <div class="').concat("flb-","list-scroll ").concat("flb-",'mt-1"> <section class="kg-list ').concat("flb-","tab-content ").concat("flb-",'mb-3"></section> {{>pagination-block}} </div> </div> </div> <div class="').concat("flb-",'row kg-viewSearch"> <div class="').concat("flb-","col-12 ").concat("flb-","col-sm-3 ").concat("flb-","col-md-3 ").concat("flb-","col-lg-3 ").concat("flb-",'col-py"> <div class="kg-facets ').concat("flb-",'modal-scroll"></div> </div> <div class="').concat("flb-","col-12 ").concat("flb-","col-sm-9 ").concat("flb-","col-md-9 ").concat("flb-","col-lg-9 ").concat("flb-",'col-py"> <div class="kg-searchHeader ').concat("flb-","border-bottom ").concat("flb-","my-2 ").concat("flb-","py-2 ").concat("flb-",'px-3"></div> <div class="').concat("flb-","search-scroll ").concat("flb-",'mt-1"> <div class="kg-searchList"></div> {{>pagination-block}} </div> </div> </div> </main>'),loading:'<div class="'.concat("flb-","text-success ").concat("flb-",'text-center"> <span class="fa fa-fw fa-2x fa-spinner fa-pulse"></span> <span class="').concat("flb-",'text">Loading...</span> </div>'),modal:'<div class="'.concat("flb-","modal ").concat("flb-",'modal-{{view}}" tabindex="-1" role="dialog"> <div class="').concat("flb-",'modal-dialog" role="document"> <div class="').concat("flb-","modal-content ").concat("flb-",'bg-light"> <div class="').concat("flb-",'modal-body"></div> </div> <div class="kg-snackbar ').concat("flb-","snackbar ").concat("flb-","alert ").concat("flb-",'alert-primary" role="alert"></div> </div> </div>')},partial:{badge:'<span class="'.concat("flb-","badge ").concat("flb-","badge-{{key}} ").concat("flb-",'badge-{{badgeType val}}"> {{translate @root._translate.type _type key}}: {{val}} </span>'),breadcrumbItem:'<a class="{{#if _classes}}{{_classes}}{{else}}'.concat("flb-","nav-item ").concat("flb-","nav-link{{/if}} ").concat("flb-",'text-truncate" href="#" data-kg-nav="{{_nav}}" data-kg-url="{{_url}}" title="{{_title}}"> {{>icon-block}} {{{_label}}} </a>'),date:"{{#dateFormat @root._options.dateFormat}}{{val}}{{/dateFormat}}",email:'{{#if val}} <a class="{{_classes}}" href="mailto:{{val}}"> {{>icon-block _classes=""}} {{#if _label}} {{_label}} {{else}} {{val}} {{/if}} </a> {{/if}}',icon:'{{#if _icon}}<span class="{{_icon}} {{_classes}} kg-icon"></span> {{/if}}',image:'<img class="'.concat("flb-",'rounded-circle {{_classes}}" src="{{_image}}">'),img:"{{#if _image}} {{>image-block _classes=_classes}} {{else}} {{>imgDefault-block _classes=_classes}} {{/if}}",imgDefault:"{{#if (imageDefaultType)}} {{>(imageDefaultType) (imageDefaultContext) _classes=_classes}} {{/if}}",list:'<div class="'.concat("flb-","card-list ").concat("flb-",'mb-2"> {{#each list}} {{#if group}} {{>listGroup-block}} {{else}} {{>listItem-block collapseId=@index}} {{/if}} {{/each}} </div>'),listGroup:'<div class="'.concat("flb-","card-group ").concat("flb-","pt-3 ").concat("flb-","pb-2 ").concat("flb-",'px-3"> {{group}} </div>'),listItem:'<div class="'.concat("flb-",'card"> <div class="').concat("flb-","d-flex ").concat("flb-","align-items-center ").concat("flb-",'my-2"> <a class="').concat("flb-","align-self-center ").concat("flb-","px-2 ").concat("flb-","py-3 ").concat("flb-","mr-2 ").concat("flb-","border-right ").concat("flb-","collapsed {{#unless secondary}}").concat("flb-",'invisible{{/unless}}" data-kg-nav="collapse" data-toggle="collapse" href="#collapsed{{_id}}{{collapseId}}" role="button" aria-expanded="false" aria-controls="{{collapseId}}"> <span class="fa fa-fw fa-chevron-up"></span> </a> {{>img-block _classes="').concat("flb-","card-image ").concat("flb-","ml-2 ").concat("flb-",'mr-2"}} <div class="').concat("flb-","d-flex ").concat("flb-","flex-fill ").concat("flb-",'align-items-center"> <div class="').concat("flb-","d-flex ").concat("flb-","flex-column{{#if primary}} ").concat("flb-",'col-7{{/if}}"> {{#if (and _viewUrl (isUrl))}} {{>url-block _classes="" _label=_title _icon=""}} {{else}} {{{_title}}} {{/if}} <span class="').concat("flb-","d-inline-flex ").concat("flb-",'text-muted">{{{_subtitle}}}</span> </div> {{>primary-block}} </div> <a href="#" data-kg-nav="{{#if _nav}}{{_nav}}{{else}}go{{/if}}" data-kg-url="{{_url.self}}" class="').concat("flb-","card-link ").concat("flb-",'btn"> <span class="fa fa-fw fa-arrow-circle-right"></span> </a> </div> {{>listItemSecondary-block}} </div>'),listItemSecondary:'{{#if secondary}} <div id="collapsed{{_id}}{{collapseId}}" class="'.concat("flb-",'collapse kg-secondary"> <div class="').concat("flb-","d-flex ").concat("flb-","flex-wrap ").concat("flb-","py-2 ").concat("flb-","ml-6 ").concat("flb-","mr-3 ").concat("flb-",'border-top"> {{#each secondary}} <span class="').concat("flb-","d-flex ").concat("flb-","flex-fill ").concat("flb-","mt-1 ").concat("flb-",'mb-2"> <span class="').concat("flb-","font-weight-bold ").concat("flb-",'mr-1"> {{translate @root._translate.property ../_type key}} </span> <span class="').concat("flb-","d-inline-block ").concat("flb-","text-width ").concat("flb-","text-muted ").concat("flb-",'text-truncate" title="{{val}}"> {{>(item) _type=../_type}} </span> </span> {{/each}} </div> </div> {{/if}}'),listText:'<ul class="'.concat("flb-","list-unstyled ").concat("flb-",'mb-0 kg-list-value"> {{#each val}} <li>{{this}}</li> {{/each}} </ul>'),pagination:'<nav class="kg-pagination '.concat("flb-","my-3 ").concat("flb-","pagination ").concat("flb-",'justify-content-center"> <span class="kg-paginationPrev ').concat("flb-","page-item ").concat("flb-","pagination-nav ").concat("flb-",'disabled"> <a class="').concat("flb-",'page-link" href="#" data-kg-nav="prev" tabindex="-1"> <span class="fa fa-fw fa-chevron-left"></span> Prev </a> </span> <span class="kg-paginationList ').concat("flb-","pagination-pages ").concat("flb-",'d-flex"></span> <span class="kg-paginationNext ').concat("flb-","page-item ").concat("flb-",'pagination-nav"> <a class="').concat("flb-",'page-link" href="#" data-kg-nav="next"> Next <span class="fa fa-fw fa-chevron-right"></span> </a> </span> </nav>'),path:'<span class="kg-long-path">{{val}}</span>',phone:'{{#if val}} <a class="{{_classes}}" href="tel:{{val}}"> {{>icon-block _classes="" _icon=_icon}} {{#if _label}} {{_label}} {{else}} {{val}} {{/if}} </a> {{/if}}',primary:'{{#if primary}} <div class="{{_classes}}"> {{#each primary}} <span class="'.concat("flb-",'mr-2">{{> (item)}}</span> {{/each}} </div> {{/if}}'),tabItem:'<a class="'.concat("flb-",'nav-link" id="{{_id}}-tab" href="#{{_id}}" data-kg-nav="tab" data-kg-url="{{_url}}" data-kg-total="{{_total}}" data-toggle="tab" role="tab" aria-controls="{{_id}}" aria-selected="false"> {{translate @root._translate.relationship _label}} <small class="').concat("flb-",'text-muted">{{_count}}</small> </a>'),text:"{{val}}",typeItem:'<a href="#" class="'.concat("flb-","list-group-item ").concat("flb-","d-flex ").concat("flb-","pb-4 ").concat("flb-","flex-wrap ").concat("flb-","flex-column ").concat("flb-","justify-content-center ").concat("flb-","align-items-center ").concat("flb-",'text-center" data-kg-nav="rel" data-kg-url="{{_url}}" data-kg-label="{{translate @root._translate.type _label}}"> <small class="').concat("flb-","badge ").concat("flb-","badge-info ").concat("flb-","badge-pill ").concat("flb-","ml-auto ").concat("flb-",'mb-2">{{_count}}</small> {{>icon-block _classes="').concat("flb-","mb-1 ").concat("flb-",'text-info"}} {{translate @root._translate.type _label}} </a>'),url:'{{#if (and _viewUrl (isUrl))}} <a class="{{_classes}}" href="{{_viewUrl}}" data-kg-nav="external" data-kg-url="{{_viewUrl}}" target="_blank"> {{>icon-block _classes=""}} {{#if _label}} {{_label}} {{else}} {{_viewUrl}} {{/if}} </a> {{/if}}'}},u={listWrapper:{full:"flb-col-12 flb-col-sm-7 flb-col-md-7 flb-col-lg-7 ",fix:"flb-col-12 "},detailWrapper:{full:"flb-col-12 flb-col-sm-5 flb-col-md-5 flb-col-lg-5",fix:"flb-col-12"},_default:"_default",urlPath:"s/knowledge-graph/templates.json",configure:function(t){$.map(u.notpartial,(function(e,a){return t.template[a]=c(e)})),u.setFields(t,u._default,{});var e=r.get(this.urlPath,{collection:t.options.collection,profile:t.options.profile},t.options.apiBase);return T.get(t,e).then((function(e){var a;if(e.data)for(var l in e.data)a=$.isString(e.data[l])?e.data[e.data[l]]:e.data[l],u.setFields(t,l,a),u.setGrouping(t,l,a.sort||""),u.setIcon(t,l,a.icon||""),u.setImageDefault(t,l,a.imageDefault||""),u.setSorting(t,l,a.sort||""),u.setUrl(t,l,a.url)})).catch((function(t){T.error(t,!0)}))},get:function(){var t,e,a=[].slice.call(arguments),l=a.shift(),n=l.template;for(t=0,e=a.length;t<e;t++)n=n[a[t]]||n[u._default];return n},getOnce:function(t,e){return c(u.onceRender[e])(t)},isBadgeField:function(t){return p._badges.indexOf(t)>-1},isDateField:function(t){return t.indexOf("date")>-1||"d"===t},isEmailField:function(t){return/\w+([-+.']\w+)*@\w+([-.]\w+)*\.\w+([-.]\w+)*/.test(t)},isPathField:function(t){return t.indexOf("path")>-1},isPhoneField:function(t){return t.indexOf("phone")>-1||t.indexOf("mobile")>-1},render:function(t,e,a){return a._options=t.options,a._options.viewUrl=t.template.url,a._options.imageDefault=t.template.imageDefault,a._translate=s.keys,t.template[e](a)},setFields:function(t,e,a){for(var l,n=Object.keys(p._fields),o=n.length,i=0;i<o;i++)l="_"+n[i],t.template.fields[l]||(t.template.fields[l]={}),t.template.fields[l][e]=a[n[i]]||p._fields[n[i]]},setGrouping:function(t,e,a){t.template.group[e]=a.field&&a.group?a.field:""},setIcon:function(t,e,a){t.template.icon[e]=(t.options.iconPrefix||"")+a},setImageDefault:function(t,e,a){a.value&&(t.template.imageDefault[e]=a,"ICON"===a.type&&(t.template.imageDefault[e].value=(t.options.iconPrefix||"")+a.value))},setSorting:function(t,e,a){t.template.sort[e]=a.field&&a.order?("DESC"===a.order?"-":"")+a.field:""},setUrl:function(t,e,a){t.template.url[e]=!$.isDefined(a)||a}};d&&(u=$.extend({},u,d));var p={_badges:["resolution","status"],_fields:{title:"t",subtitle:"subtitle",desc:"c",image:"image",viewUrl:"FUNkgLiveUrl",list:{primary:[],secondary:[]},detail:{primary:[],secondary:[]}},graph:{node:{_id:"node.id",_url:{self:"links.0.href",types:"links.1.href",typesLeaf:"links.2.href"},_type:"node.labels.0",_labels:"node.labels",_fields:"node.propertyList"},rel:{_id:["relationship","direction.name"],_label:["relationship","direction.name"],_count:"rel_count",_url:"links.0.href"},type:{_count:"hierarchy.data.typeCount",_url:"hierarchy.data.links.1.href",_type:"type",_label:"hierarchy.data.label"},pagination:{start:"start",size:"pageSize"}},search:{node:{_id:"rank",_url:{self:"liveUrl"},_type:"listMetadata.FUNkgNodeLabel.0",_labels:"listMetadata.FUNkgNodeLabel",_fields:"listMetadata",_title:"title",_desc:"summary",_viewUrl:"liveUrl"},pagination:{start:"start_rank",size:"num_ranks"},summary:{_start:"resultsSummary.currStart",_end:"resultsSummary.currEnd",_query:"query",_total:"resultsSummary.totalMatching",_rank:"resultsSummary.numRanks"}},retrieve:function(t,e,a,l,n){var o=[];return p[a]&&p[a][l]&&(n||(n={}),o=function e(n,o){var i,r,s,c=Object.keys(o),f=n.length,d=[];for(i=0;i<f;i++)r=u(n[i],c),$.isFunction(p[l])&&p[l](t,r,a),r._fields&&p.fields(t,r),r._type&&p.icon(t,r),d.push(r);return d;function u(t,a){var l,n=a.length,i={},r=[];for(l=0;l<n;l++)(s=o[a[l]])?i[a[l]]=$.isString(s)?$.dataVals(t,s):$.isArray(s)?u(t,s):e([t],s)[0]:r.push($.dataVals(t,a[l]));return r.length?r.join("-"):i}}(e,$.extend(!0,p[a][l],n))),o},fields:function(t,e){var a,l,n,o=Object.keys(this._fields);for(a=0,l=o.length;a<l;a++)(n=u.get(t,"fields","_"+o[a],e._type))&&$.isString(n)&&e._fields[n]&&(e["_"+o[a]]=JSON.parse(JSON.stringify(e._fields[n]))),"viewUrl"===o[a]&&(e._viewUrl=p.viewUrl(t,e._viewUrl))},icon:function(t,e){e._icon=u.get(t,"icon",e._type)},rel:function(t,e){var a=t.template.sort[r.getPathParts(e._url,"/",2)],l=r.getUrl(e._url),n=r.getPathParams(e._url);a?(n.sort=a,e._url=r.get(l,n,t.options.apiBase)):e._url=p.absoluteApiUrl(t,e._url),e._label&&(e._label=e._label.replace("-","."))},node:function(t,e,a){"graph"===a&&(e.self&&(e.self=p.absoluteApiUrl(t,e.self)),e.types&&(e.types=p.absoluteApiUrl(t,e.types)),e.typesLeaf&&(e.typesLeaf=p.absoluteApiUrl(t,e.typesLeaf))),"search"===a&&e._type&&(e._type=e._type.toLowerCase())},summary:function(t,e){e._query&&(e._query=e._query.replace(t.options.searchParams.query_sand,""))},type:function(t,e){e._url&&(e._url=p.absoluteApiUrl(t,e._url))},viewUrl:function(t,e){var a,l;if(e)for($.isString(e)&&(e=[e]),a=0,l=e.length;a<l;a++)e[a]=r.setUrl(e[a],t.options.urlPrefix);return e},absoluteApiUrl:function(t,e){return r.get(e,null,t.options.apiBase)}},b={getElement:function(t,e){return(e||$("body")).find("."+t)},getElementLabel:function(t,e){var a=b.getElement(t,e);return a.attr("data-kg-label")?a.attr("data-kg-label"):a.text()},getElementUrl:function(t,e){var a=b.getElement(t,e);return a.attr("data-kg-url")?a.attr("data-kg-url"):a.attr("href")},createElement:function(t,e,a,l,n,o,i){a||(a="div"),i||(i=!1);var r=b.getElement(t,e);return r.length&&!i||(r=$("<"+a+">").attr("class",t),n&&(n.class&&(r.addClass(n.class),delete n.class),r.attr(n)),l&&r.html(l),o&&$.each(o,(function(t,e){r.on(t,e)})),e&&e.append(r)),r},showElement:function(t){t.show().css("display","flex")},getDetailsTitle:function(t){return b.getElementLabel("kg-title",t.detail)},getDetailsUrl:function(t){return b.getElementUrl("kg-content",t.detail)}},g={currentPage:function(t){return t.results.url},hide:function(t){t.pagination.hide()},init:function(t){t.results.total=null,this.hide(t)},set:function(t,e,a,l){l&&(t.results.model=l),e&&(t.results.url=e),$.isDefined(a)&&(t.results.total=parseInt(a)),t.results.total>t.results.size?(this.show(t),this.update(t)):this.hide(t)},show:function(t){b.showElement(t.pagination)},update:function(t){var e=parseInt(r.getPathParams(t.results.url)[p[t.results.model].pagination.start]||1),a=e-t.results.size;a>-1?(t.paginationPrev.removeClass("flb-disabled"),t.paginationPrev.find("a").attr("data-kg-url",this.url(t,a)).removeAttr("disabled")):(t.paginationPrev.addClass("flb-disabled"),t.paginationPrev.find("a").attr("disabled","disabled"));var l=e+t.results.size;l<t.results.total?(t.paginationNext.removeClass("flb-disabled"),t.paginationNext.find("a").attr("data-kg-url",this.url(t,l)).removeAttr("disabled")):(t.paginationNext.addClass("flb-disabled"),t.paginationNext.find("a").attr("disabled","disabled")),t.options.maxPagination&&(t.paginationList.html(""),function(e,a,l,n){$.isDefined(n)||(n=0);a<l&&(l=a);for(var o=Math.min(a+n-l,Math.max(n,e-(l/2|0))),i=o+l;o<i;o++)t.paginationList.append(u.render(t,"paginationItem",{_label:o+1,_isActive:e===o,_url:g.url(t,o*t.results.size+1)}))}((e-1)/t.results.size,Math.ceil(t.results.total/t.results.size),t.options.maxPagination))},url:function(t,e){var a=t.results.url,l=r.getPathParams(a);return l[p[t.results.model].pagination.size]=t.results.size,l[p[t.results.model].pagination.start]=e,r.get(r.getPathParts(a).join("/"),l)}},h={eventSuffix:"kg-search",init:function(t){t.viewSearch.hide(),t.options.searchUrl?(t.searchBox.find('[type="button"]').attr("data-kg-url",t.options.searchUrl),t.searchBox.find("input").on("focus",(function(){$(document).on("keydown."+h.eventSuffix,(function(e){if(13===(e.keyCode||e.which))return e.preventDefault(),t.searchBox.find('[type="button"]').click(),!1}))})).on("focusout",(function(){$(document).off("keydown."+h.eventSuffix)}))):t.searchBox.hide()},reset:function(t){t.searchBox.find("input").val("")},current:function(t){var e=g.currentPage(t);return{_label:"Search for "+t.searchHeader.find("em").text(),_url:e,_type:void 0,_tab:void 0,_page:e,_model:"search"}},getUrl:function(t,e,a){return r.setUrl(t.options.searchUrl+e,t.options.apiBase,a)},isUrl:function(t,e){return!!e.match(t.options.searchUrl)}},m={convertToView:function(t,e,a){var l,n,o=e.length;for(l=0;l<o;l++)i(n=u.get(t,"fields",a,e[l]._type),"primary",e[l],e[l]._type),i(n,"secondary",e[l],e[l]._type);return e;function i(e,l,n,o){if(n[l]=[],e[l])for(var i=0,r=e[l].length;i<r;i++)n._fields[e[l][i]]&&n[l].push({key:e[l][i],val:m.convertField(t,o,a.substring(1)+l.capitalize(),e[l][i],n._fields[e[l][i]])})}},convertField:function(t,e,a,l,n){if($.isFunction(t.options.field.callback)){var i=t.options.field.callback.call(null,e,a,l,n);i&&$.isArray(i)?n=i:o.warn("Incorrect value returned by callback. Expected array but got",i+"")}return"list"===t.options.field.display?n:n.join(t.options.field.separator)},groupNodes:function(t,e,a,n){var o,i,r,s,c=[];for(t.template.group[a]&&(r=$.isString(t.template.group[a])?t.template.group[a]:t.template.group[a][n]||t.template.group[a][u.keyDefault]),o=0,i=e.length;o<i;o++){if(r&&e[o]._fields[r]&&e[o]._fields[r].length){var f=u.isDateField(r)?l(e[o]._fields[r][0]):e[o]._fields[r][0];f!=s&&(s=f,c.push({group:f}))}c.push(e[o])}return c},mapLinks:function(t){var e,a,l={};for(e=0,a=t.links.length;e<a;e++)l[t.links[e].rel]=t.links[e].href;return l},processNodes:function(t,e,a){var l=r.storageKey(e,t.options.apiBase);if(i.isItem(l))return i.getItem(l);var n,o,s=p.retrieve(t,a.nodes,"graph","node"),c=[];for(n=0,o=s.length;n<o;n++)i.setItem(r.storageKey(s[n]._url.self,t.options.apiBase),{list:[f(s[n])],total:1}),c.push(s[n]._id);return(a.nodesSummary.totalMatching>1||!r.isNodeDetail(e))&&i.setItem(r.storageKey(e,t.options.apiBase),{list:c,total:a.nodesSummary.totalMatching}),{list:s,total:a.nodesSummary.totalMatching};function f(e){for(var a=["title","subtitle","desc"],l=0,n=a.length;l<n;l++)e["_"+a[l]]&&(e["_"+a[l]]=m.convertField(t,e._type,a[l],null,e["_"+a[l]]));return e}},processRels:function(t,e,a){var l=p.retrieve(t,a,"graph","rel");return i.setItem(r.storageKey(e,t.options.apiBase),l),l},processTypes:function(t,e,a){var l=p.retrieve(t,a,"graph","type");return i.setItem(r.storageKey(e,t.options.apiBase),l),l},processSearch:function(t,e,a){var l=[],n={},o=[];if(a.response&&a.response.resultPacket){var i,r,s,c;for(o=a.response.facets||[],n=p.retrieve(t,[a.response.resultPacket],"search","summary")[0],l=p.retrieve(t,a.response.resultPacket.results,"search","node"),i=0,r=o.length;i<r;i++)for(o[i].unselectAllUrl&&o[i].selected&&(o[i]._url=h.getUrl(t,o[i].unselectAllUrl),o[i]._label="Clear all"),s=0,c=o[i].allValues.length;s<c;s++)o[i].allValues[s]._url=h.getUrl(t,o[i].allValues[s].toggleUrl);for(i=0,r=l.length;i<r;i++)l[i]._url.self=T.getUrl(t,l[i]._url.self)}return{list:l,summary:n,facets:o}}},v=function(){NProgress.start()},k=function(){NProgress.done()},_=function(t){t.back.html(t.stackUrl.length?u.render(t,"back",{}):"")},y=function(t){t.back.html("")},x=function(t,e){$.isDefined(e)?t.stackBreadcrumb=t.stackBreadcrumb.slice(0,t.stackBreadcrumb.indexOf(e)):t.stackUrl.length?t.stackBreadcrumb.indexOf(t.stackUrl.length-1)<0&&t.stackBreadcrumb.push(t.stackUrl.length-1):t.stackBreadcrumb=[];var a=t.stackBreadcrumb.length,l=Math.floor(t.options.maxBreadcrumb/2);function n(e,a){for(var l,n=[];e<a;e++)(l=t.stackUrl[t.stackBreadcrumb[e]])&&(l._idx=t.stackBreadcrumb[e],n.push(l));return n}t.breadcrumb.html(u.render(t,"breadcrumb",{list:a>t.options.maxBreadcrumb?Array.prototype.concat(n(0,l),[{_label:"More",_sub:n(l,a-l-1)}],n(a-l-1,a)):n(0,a)}))},w=function(t){t.breadcrumb.html("")},U={backdrop:"flb-modal-backdrop",backdropShow:"flb-show",opened:"flb-modal-open",selector:"flb-modal",eventSuffix:"kg-modal",init:function(t){b.getElement(this.selector,t.container).on("mouseup."+this.eventSuffix,(function(e){e.target===this&&t.close()})),$(document).on("keydown."+this.eventSuffix,(function(e){27==(e.keyCode||e.which)&&t.close()}))},destroy:function(t){b.getElement(this.selector,t.container).off("mouseup."+this.eventSuffix),$(document).off("keydown."+this.eventSuffix)},show:function(t){t.isOpen||b.getElement(this.selector,t.container).show(400,(function(){U.showBackdrop(t),t.isOpen=!0,$(this).attr("aria-hidden",!1),t.options.modalFocus&&$(this).focus()}))},hide:function(t){t.isOpen&&b.getElement(this.selector,t.container).hide(400,(function(){U.hideBackdrop(t),t.isOpen=!1,$(this).attr("aria-hidden",!0)}))},showBackdrop:function(t){t.backdrop||(t.backdrop=b.createElement(U.backdrop,null,"div",null,{class:U.backdropShow})),t.options.modalBackdrop&&$("body").addClass(U.opened).append(t.backdrop)},hideBackdrop:function(t){$("body").removeClass(U.opened),t.backdrop.remove()}},L={selector:'[data-toggle="collapse"]',active:"flb-show",collapse:"flb-collapse",collapsed:"flb-collapsed",toggle:function(t,e){e.hasClass(this.collapsed)?this.show(t,e):this.hide(t,e)},show:function(t,e){e.removeClass(L.collapsed).attr("aria-expanded",!0),L.getCollapsible(t,e).each((function(){$(this).addClass(L.active)}))},hide:function(t,e){e.addClass(L.collapsed).attr("aria-expanded",!1),L.getCollapsible(t,e).each((function(){$(this).removeClass(L.active)}))},getCollapsible:function(t,e){return e.attr("data-target")?t.container.find("."+this.collapse+"."+e.attr("data-target")):e.attr("href")?t.container.find("."+this.collapse+e.attr("href")):void 0}},P={eventSuffix:".kg",name:function(t){return t+this.eventSuffix},nav:function(t,e){P.factory("nav",t,e)},render:function(t,e){P.factory("render",t,e)},factory:function(t,e,a){$.isFunction(a)&&e.container.bind(P.name(t),(function(){return a.apply(null,[].slice.call(arguments))}))}},S={selector:'[role="alert"]',active:"flb-show",show:function(t,e){t.snackbar.hasClass(this.active)||(t.snackbar.text(e||"").addClass(this.active),setTimeout((function(){S.hide(t)}),3e3))},hide:function(t){t.snackbar.hasClass(this.active)&&t.snackbar.removeClass(this.active)}},C=function(t,e){var a=document.createElement("textarea"),l="Link was copied to the clickboard";a.value=e,document.body.appendChild(a),a.select(),document.execCommand("copy"),document.body.removeChild(a),t.snackbar?S.show(t,l):alert(l)},F=function(t,e){var a=e._fields&&e._fields.FUNkgLiveUrl&&e._fields.FUNkgLiveUrl[0];return a&&t.options.shareUrl?r.setUrl(t.options.shareUrl,t.options.apiBase,Object.assign(t.options.shareParams||{},{collection:t.options.collection,profile:t.options.profile,targetUrl:a})):void 0},B={selector:'[role="tab"]',active:"flb-active",toggle:function(t,e){this.hide(t),this.show(t,e)},show:function(t,e){e.hasClass(this.active)||(e.addClass(this.active),t.list.find(e.attr("href")).addClass(this.active).show(),g.set(t,e.attr("data-kg-url"),e.attr("data-kg-total"),"graph"))},hide:function(t){g.hide(t),t.tabs.find("."+this.active).removeClass(this.active),t.list.find("."+this.active).removeClass(this.active).hide()},get:function(t){return b.getElement(this.active,t.tabs)},getLabel:function(t){return b.getElementLabel(this.active,t.tabs)},getUrl:function(t){return this.get(t).attr("href")},getPanel:function(t,e){return t.list.find(e)},set:function(t,e){var a=e?'[href="'+e+'"]':this.selector+":first-child";this.toggle(t,t.tabs.find(a))},setData:function(t,e,a){t.tabs.find('[href="'+e+'"]').attr({"data-kg-url":a._url,"data-kg-total":a._total})}},D={selector:'[data-kg-nav="rel"]',active:"flb-active",get:function(t){return b.getElement(this.active,t.types)},getLabel:function(t){return b.getElementLabel(this.active,t.types)},getUrl:function(t){return b.getElementUrl(this.active,t.types)},set:function(t,e){var a=e?'[data-kg-url="'+e+'"]':this.selector+":first-child";this.get(t).removeClass(this.active),t.types.find(a).addClass(this.active),t.header.html(u.render(t,"listHeader",{title:D.getLabel(t),desc:"Discover "+D.getLabel(t).toLowerCase()+' related to "'+b.getDetailsTitle(t)+'"'}))}},I={go:function(t,e,a){$.isDefined(a)||(a=!1);var l=e.attr("data-kg-nav"),n=e.attr("data-kg-url");if("back"===l)return I.back(t,e),!1;if("collapse"===l)return L.toggle(t,e),!1;if("close"===l)return t.close(),!1;if("external"===l)return!0;if("share"===l)return e.trigger(P.name("nav"),[t,n,l]),C(t,n),!1;if("tab"===l)return e.trigger(P.name("nav"),[t,n,l]),g.init(t),I.push(t),B.toggle(t,e),!1;if("fixed"!==t.container.attr("data-kg-context")){var o=m.processNodes,i=E.nodesDetails,s={},c=!1;if(l.indexOf("init")<0&&!a&&I.push(t),"breadcrumb"===l){var f=parseInt(n);x(t,f),n=t.stackUrl[f]._url,h.isUrl(t,n)?l="facet":r.isNodeDetail(n)||(i=E.nodesList),c=!0}return l.indexOf("go")>-1&&(x(t),c=!0),"home"===l&&(n=I.head(t)._url,c=!0),"next"!==l&&"page"!==l&&"prev"!==l||(t.results.url=n,"graph"===t.results.model?i=E.tabsList:(o=m.processSearch,i=E.searchList),s=this.current(t)),"facet"===l&&(t.results.url=n,o=m.processSearch,i=E.searchList),"search"===l&&(x(t),n=r.get(n,Object.assign(t.options.searchParams||{},{collection:t.options.collection,profile:t.options.profile,query:e.closest("form").find('input[type="search"]').val()||""})),t.results.url=n,o=m.processSearch,i=E.searchList),"rel"===l&&(E.load(t,"rel"),o=m.processRels,i=E.tabsNav,D.set(t,n)),e.trigger(P.name("nav"),[t,n,l]),c&&E.load(t,"all"),T.get(t,n,o).then((function(t){i(t.box,t.url,t.data,s)})).catch((function(t){T.error(t)})),!1}N.openAutoFromFixed(t,e)},back:function(t,e){var a=I.current(t),l=I.pop(t);_(t),t.stackUrl.length||w(t),l&&(l._url!=a._url?(e.attr({"data-kg-nav":"search"===l._model?"facet":"go","data-kg-url":l._url}),I.go(t,e,!0),x(t,t.stackUrl.length)):l._type!=a._type?(e.attr({"data-kg-nav":"rel","data-kg-url":l._type}),I.go(t,e,!0)):l._tab!=a._tab?(B.set(t,l._tab),e.trigger(P.name("nav"),[t,B.getUrl(t),"tab"])):l._page!=a._page&&(e.attr({"data-kg-nav":"page","data-kg-url":l._page}),I.go(t,e,!0)))},current:function(t){return t.viewSearch.is(":visible")?h.current(t):{_label:b.getDetailsTitle(t),_url:b.getDetailsUrl(t),_type:D.getUrl(t),_tab:B.getUrl(t),_page:g.currentPage(t),_model:"graph"}},init:function(t,e){t.stackUrl=e&&"init-go"===$(e).attr("data-kg-nav")&&t.stackUrl.length?[t.stackUrl[0]]:[],x(t)},head:function(t){if(t.stackUrl.length)return t.stackUrl[0]},peek:function(t){return t.stackUrl[t.stackUrl.length-1]},pop:function(t){if(t.stackUrl.length)return t.stackUrl.pop()},push:function(t){var e=I.current(t);I.peek(t)!=e&&e._url&&(t.stackUrl.push(e),_(t))}},N={triggers:["icon","button","link","fixed","full"],instance:{id:null,container:null,stackUrl:[],stackBreadcrumb:[],events:null,isOpen:!1,open:null,close:null,results:{size:10,total:null,url:null},template:{fields:{},group:{},icon:{},imageDefault:{},sort:{},url:{}}},open:function(t){U.show(t)},openAutoFromFixed:function(t,e){t.container.attr("data-kg-context","auto"),b.getElement("flb-modal",t.container).removeClass("flb-modal-fixed").addClass("flb-modal-auto");var a=!0;"go"===e.attr("data-kg-nav")&&(e.attr("data-kg-nav","init-go"),a=!1),E.init(t,e,a),t.options.modalBackdrop=!0,t.options.modalFocus=!0,U.init(t),U.showBackdrop(t)},openAuto:function(){this.options.modalBackdrop=!0,this.options.modalFocus=!0,N.open(this)},openFixed:function(){this.options.modalBackdrop=!1,this.options.modalFocus=!1,N.open(this)},openFull:function(){this.options.modalBackdrop=!1,this.options.modalFocus=!0,N.open(this)},closeAuto:function(){U.hide(this)},closeFixed:function(){if(this.isOpen){var t=I.head(this);t?T.get(this,t._url).then((function(t){E.init(t.box),E.nodesList(t.box,t.url,t.data)})).catch((function(t){T.error(t)})):this.listWrapper[0].offsetHeight&&N.fullToFixed(this,"detail"),this.container.attr("data-kg-context","fixed"),b.getElement("flb-modal",this.container).removeClass("flb-modal-auto").addClass("flb-modal-fixed"),U.hideBackdrop(this),U.destroy(this),this.options.modalBackdrop=!1}},closeFull:function(){},clean:function(){if(arguments.length){var t,e,a=[].slice.call(arguments);for(t=0,e=a.length;t<e;t++)a[t].html("")}},fixedToFull:function(t){t.tabsWrapper.show(),t.detailWrapper.removeClass(u.detailWrapper.fix).addClass(u.detailWrapper.full).show(),t.listWrapper.removeClass(u.listWrapper.fix).addClass(u.listWrapper.full).show()},fullToFixed:function(t,e){w(t),"detail"===e?(t.detailWrapper.removeClass(u.detailWrapper.full).addClass(u.detailWrapper.fix),t.listWrapper.hide()):(t.listWrapper.removeClass(u.listWrapper.full).addClass(u.listWrapper.fix),t.detailWrapper.hide(),t.tabsWrapper.hide())}},O={selector:'[data-toggle="dropdown"]',active:"flb-show",menu:"flb-dropdown-menu",init:function(t){t.container.on("click",this.selector,(function(e){e.preventDefault(),e.stopPropagation(),O.toggle(t,$(this))}))},toggle:function(t,e){var a=e.parent().find("."+this.menu);a.length&&(a.hasClass(this.active)?(e.attr("aria-expanded",!1),this.hide(t,a)):(e.attr("aria-expanded",!0).focus(),this.show(t,a)))},show:function(t,e){e.hasClass(this.active)||(t.container.find("."+this.menu).removeClass(this.active),e.addClass(this.active),b.getElement(U.selector,t.container).on("mouseup",(function(a){a.target!==e&&O.hide(t,e)})))},hide:function(t,e){e.hasClass(this.active)&&e.removeClass(this.active)}},W={active:"flb-show",init:function(t){t.scrollerRight.on("click",(function(e){e.stopPropagation(),e.preventDefault(),$(this).addClass("flb-disabled").attr("disabled","disabled"),W.show(t,t.scrollerLeft),t.tabs.animate({left:"-="+W.moveRight(t)},500,(function(){t.scrollerRight.removeClass("flb-disabled").removeAttr("disabled"),Math.round(W.getHiddenListWidth(t))||W.hide(t,t.scrollerRight)}))})),t.scrollerLeft.on("click",(function(e){e.stopPropagation(),e.preventDefault(),$(this).addClass("flb-disabled").attr("disabled","disabled"),W.show(t,t.scrollerRight),t.tabs.animate({left:"+="+W.moveLeft(t)},500,(function(){t.scrollerLeft.removeClass("flb-disabled").removeAttr("disabled"),W.getListPosition(t).left||W.hide(t,t.scrollerLeft)}))}))},readjust:function(t){var e=this.getListPosition(t).left;this.getVisibleListWidth(t)<this.getListWidth(t)?this.show(t,t.scrollerRight):this.hide(t,t.scrollerRight),e<0?this.show(t,t.scrollerLeft):(this.hide(t,t.scrollerLeft),t.tabs.animate({left:"-="+e+"px"},"slow"))},set:function(t){t.tabs.css("left",0),this.readjust(t)},show:function(t,e){if(e){if(e.hasClass(this.active))return;e.addClass(this.active)}else this.show(t,t.scrollerLeft),this.show(t,t.scrollerRight)},hide:function(t,e){if(e){if(!e.hasClass(this.active))return;e.removeClass(this.active)}else this.hide(t,t.scrollerLeft),this.hide(t,t.scrollerRight)},moveLeft:function(t){var e=Math.abs(W.getListPosition(t).left);return e<this.getVisibleListWidth(t)?e:this.getVisibleListWidth(t)},moveRight:function(t){var e=Math.abs(this.getHiddenListWidth(t));return e<this.getVisibleListWidth(t)?e:this.getVisibleListWidth(t)},getVisibleListWidth:function(t){return t.scroller.outerWidth()},getHiddenListWidth:function(t){return this.getVisibleListWidth(t)-this.getListWidth(t)-this.getListPosition(t).left},getListWidth:function(t){var e=0;return t.tabs.find(".flb-nav-link").each((function(){e+=$(this).outerWidth()})),e},getListPosition:function(t){return t.tabs.position()}},E={init:function(t,e,a){return a||(this.load(t,"all"),h.reset(t)),I.init(t,e),e&&I.go(t,$(e)),t.open(e),!1},destroy:function(t){"fixed"!==t.view&&$(".kg-trigger").remove(),t.container.remove()},configure:function(t){t.loader=b.createElement("kg-loader",null,"div",u.onceRender.loading),t.container=b.createElement("kg-box",$("auto"===t.view?"body":t.context),"div",u.getOnce(t,"modal"),{"data-kg-id":t.id,id:"kg"+t.id,"data-kg-context":t.view}),b.getElement("flb-modal-body",t.container).html(u.getOnce(t,"layout"));for(var e=["viewGraph","viewSearch","nav","back","breadcrumb","searchBox","searchHeader","searchList","facets","detailWrapper","detail","types","header","tabsWrapper","tabs","listWrapper","list","pagination","paginationList","paginationPrev","paginationNext","scroller","scrollerLeft","scrollerRight","snackbar"],a=e.length,l=0;l<a;l++)t[e[l]]=b.getElement("kg-"+e[l],t.container);t.container.on("click","[data-kg-nav]",(function(){return I.go(t,$(this))})),O.init(t),h.init(t),W.init(t),"auto"===t.view&&U.init(t),t.options.events&&$.each(t.options.events,(function(e,a){P[e]&&P[e](t,a)}))},load:function(t,e){"all"===e&&N.clean(t.detail,t.types,t.header,t.tabs,t.list),"rel"===e&&N.clean(t.header,t.tabs,t.list),"all"!==e&&"rel"!==e||(W.hide(t),E.loaderShow(t,t.tabs.css("left","calc(50% - 3.6em)"))),g.init(t)},loaderShow:function(t,e){e.html(t.loader)},loaderHide:function(t,e){e.find(t.loader).remove()},alert:function(t,e,a,l){var n=u.render(t,"alert",{status:a,msg:l,type:e});t.list.html(n),t.searchList.html(n)},error:function(t,e,a){this.alert(t,"danger",e,a+". Please, try again later..."),E.loaderHide(t,t.tabs)},notFound:function(t,e){this.alert(t,"info",null,e||"No data found")},nodesButton:function(t,e,a){$(t.context).attr({"data-kg-nav":"init","data-kg-url":e,title:n,style:"cursor: pointer"}).on("click",(function(){return E.init(t,this)})),t.container.trigger("kg:render",[t,e,a])},nodesDetails:function(t,e,a,l){t.viewGraph.show(),t.viewSearch.hide(),N.fixedToFull(t),E.loaderShow(t,t.tabs),E.details(t,e,a,l),t.container.trigger("kg:render",[t,e,a,l])},nodesList:function(t,e,a){if(t.viewGraph.show(),t.viewSearch.hide(),1===a.list.length)E.loaderShow(t,t.detail),N.fullToFixed(t,"detail"),E.details(t,e,a);else{E.loaderShow(t,t.list),N.fullToFixed(t,"list");var l=I.current;I.current=function(){return{_label:"KG list",_url:e}},I.push(t),I.current=l;var n=r.getPathParams(e);t.header.html(a.total+" Knowledge Graph links found "+(n.query?"for <b>"+n.query+"</b>":"on this page")+":"),t.list.html(u.render(t,"list",{list:m.convertToView(t,a.list,"_list")}))}y(t),t.container.trigger("kg:render",[t,e,a])},searchList:function(t,e,a){t.viewGraph.hide(),t.viewSearch.show(),a.list&&a.list.length?(t.searchHeader.html(u.render(t,"searchHeader",a.summary)),t.searchList.html(u.render(t,"list",{list:m.convertToView(t,a.list,"_list")})),t.searchList[0].parentNode.scrollTop=0,t.facets.html(u.render(t,"facets",a.facets))):(t.searchHeader.html(""),t.searchList.html(""),t.facets.html(""),E.notFound(t)),g.set(t,e,a.summary._total,"search")},details:function(t,e,a,l){if(!a.list.length)return E.notFound(t),void E.loaderHide(t,t.tabs);(a=m.convertToView(t,a.list,"_detail")[0])._shareUrl=F(t,a),(a._url.typesLeaf||a._url.types)&&T.get(t,a._url.typesLeaf||a._url.types,m.processTypes).then((function(t){E.typesList(t.box,t.url,t.data,l)})).catch((function(t){T.error(t)})),t.detail.html(u.render(t,"detail",a));var n=t.detail.find(".kg-long-path").parent();n&&n.get(0)&&"TD"===n.get(0).nodeName&&t.detail.find(".kg-long-path").parent().addClass("kg-long-path")},typesList:function(t,e,a,l){if(!a.length)return E.notFound(t,"No related data found"),void E.loaderHide(t,t.tabs);T.get(t,l&&l._type?l._type:a[0]._url,m.processRels).then((function(t){E.tabsNav(t.box,t.url,t.data,l)})).catch((function(t){T.error(t)})),t.types.html(u.render(t,"type",a)),D.set(t,l?l._type:void 0)},tabsList:function(t,e,a,l){var n=r.getPathParts(e,t.options.apiBase),o=n[2],i=n[3],s=m.groupNodes(t,m.convertToView(t,a.list,"_list"),o,i);B.setData(t,l._id?"#"+l._id:l._tab,{_url:e,_total:a.total}),l._id?t.list.append(u.render(t,"tabList",{list:s,_id:l._id})):(B.getPanel(t,l._tab).html(u.render(t,"list",{list:s})),g.set(t,e)),t.list[0].parentNode.scrollTop=0},tabsNav:function(t,e,a,l){"fixed"!=t.container.attr("data-kg-context")&&N.fixedToFull(t),l||(l={}),E.loaderShow(t,t.list),2===a.length&&"all-undirected"===a[0]._id&&a.shift(),t.tabs.html(u.render(t,"tab",a)),W.set(t);for(var n=[],o=0,i=a.length;o<i;o++)n.push(Promise.all([T.get(t,a[o]._url,m.processNodes),Object({_id:a[o]._id},l)]).then((function(t){return E.tabsList(t[0].box,t[0].url,t[0].data,t[1])})));Promise.all(n).then((function(){E.loaderHide(t,t.list),B.set(t,l&&l._tab?l._tab:void 0)})).catch((function(t){T.error(t)}))}},T={urlPrefix:"kg/nodes",keywordsV:1,keywords:function(){var t=this;T.get(t,r.get("nodes",{keywords:T.getInitContent(t)},t.options.apiBase),m.processNodes).then((function(e){"button"===t.options.trigger?E.nodesButton(e.box,e.url,e.data):(E.init(e.box),E.nodesList(e.box,e.url,e.data))})).catch((function(t){T.error(t)})).then((function(){k()}))},nodes:function(){var t=this;T.get(t,T.getUrl(t,T.resolveId(t)),m.processNodes).then((function(e){"button"===t.options.trigger?E.nodesButton(e.box,e.url,e.data):(E.init(e.box),"full"===t.options.trigger?E.nodesDetails(e.box,e.url,e.data):E.nodesList(e.box,e.url,e.data))})).catch((function(e){T.error(e),"full"===t.options.trigger&&e.box&&e.box.container&&e.box.open()})).then((function(){k()}))},getUrl:function(t,e){return r.get(T.urlPrefix,{liveUrl:e,collection:t.options.collection,profile:t.options.profile},t.options.apiBase)},resolveId:function(t){var e=r.getPathParams(window.location.search).targetUrl,a=window.location.href;if(e)a=e;else if(t.options.targetUrl&&$.isString(t.options.targetUrl))a=t.options.targetUrl;else if(t.options.contentSelector){var l=document.querySelectorAll(t.options.contentSelector);if(a=void 0,l&&l.length){for(var n=0,i=l.length;n<i;n++)if(a="attr"===t.options.contentType?l[n].getAttribute(t.options.contentAttr):l[n].innerText){a=a.trim();break}}else o.warn('Element "'+t.options.contentSelector+'" has not been found')}return a},error:function t(e,a){if(e.box)try{var l=e.error.response?JSON.parse(e.error.response):"";a?o.log(e.url,l.status,l.error):l.status&&500!=l.status?E.error(e.box,l.status,l.error):E.error(e.box,l.status,"Something went wrong")}catch(t){o.log(t)}},get:function(t,e,a,l){return T.request(t,"get",e,l,a)},post:function(t,e,a,l){return T.request(t,"post",e,l,a)},request:function(t,e,a,l,n){return new Promise((function(o,s){var c=r.storageKey(a,t.options.apiBase);if(i.isItem(c))return o({box:t,url:a,data:i.getItem(c)}),null;var f=new XMLHttpRequest;f.onload=function(){if(200!==this.status)s({box:t,url:a,error:this});else try{var e=JSON.parse(this.responseText);o({box:t,url:a,data:n&&$.isFunction(n)?n(t,a,e):e})}catch(e){s({box:t,url:a,error:e})}},f.onerror=function(){s({box:t,url:a,error:f})},f.open(e,a,!0),f.setRequestHeader("Accept","application/json"),f.setRequestHeader("Content-Type","text/plain"),f.send(l||{})}))}},j={},A=function(t,e){return e.collection&&e.profile?(this.set(t,e).init(),this):(o.warn('Missing "collection" and/or "profile" parameter'),null)};A.defaults={apiBase:"/",contentFetcher:"nodes",contentSelector:null,contentType:"text",contentAttr:null,targetUrl:!0,dateFormat:"DD MMMM YYYY, HH:mm",field:{callback:null,display:"string",separator:", "},iconPrefix:"fa fa-fw fa-",maxBreadcrumb:5,maxPagination:5,maxResults:10,shareUrl:"s/knowledge-graph/index.html",shareParams:{},searchUrl:"s/search.json",searchParams:{SF:"[^(?i)(?!Fun).*,FUNkgNodeLabel]",query_sand:"|FUNkgNodeLabel:$++ |FUNkgNodeNames:$++"},trigger:"button",urlPrefix:"/s/"},A.prototype.get=function(){return j},A.prototype.set=function(t,e){var a=$.extend(!0,{},N.instance);return a.id=Math.floor(100*Math.random())+1,a.context=t instanceof HTMLDocument||t===window?"body":t,a.options=this.option(a,e),E.configure(a),j=a,this},A.prototype.init=function(){var t=this.get();return v(),Promise.all([u.configure(t),s.configure(t)]).then((function(){})).catch((function(t){T.error(t,!0)})).then((function(){t.data&&t.data()})),this},A.prototype.option=function(t,e,a){if(1===arguments.length)return t.options;var l=$.isObject(e)?e:{};if($.isString(e)){if(2===arguments.length||!$.isDefined(a))return $.dataVals($.extend({},t.options),e);l[e]=a}for(var n in l)o(n,l[n]);return l.shareUrl=r.setUrl(l.shareUrl,l.apiBase),l.searchUrl=r.setUrl(l.searchUrl,l.apiBase),l;function o(e,a){if("apiBase"===e&&a&&(l[e]=r.setBase(a)),"contentFetcher"===e&&(t.data=T[a]),"contentSelector"===e&&a&&(l[n]=$.isString(a)?[a]:a||[]),"maxResults"===e&&a&&(t.results.size=parseInt(a)),"trigger"===e){N.triggers.indexOf(a)<0&&(a=N.triggers[0]),l[n]=a,t.view="full"===a||"fixed"===a?a:"auto";var o=t.view.capitalize();t.open=N["open"+o],t.close=N["close"+o]}}},f(u.partial),$.fn.knowledgeGraph=function(){var t=[].slice.call(arguments),e=t.shift();return this.each((function(){var a=$(this),l=a.data("flb.knowledgeGraph"),n=$.extend(!0,{},A.defaults,l||{},$.isObject(e)&&e);!l&&/destroy|hide/.test(e)||(l||a.data("flb.knowledgeGraph",l=new A(this,n)),$.isString(e)&&$.isFunction(l[e])&&l[e].apply(a,t))}))},$.fn.knowledgeGraph.Constructor=A,$.fn.knowledgeGraph.version="2.8.7",$.isDefined=function(t){return void 0!==t},$.isObject=function(t){return"object"===e(t)},$.isString=function(t){return"string"==typeof t},$.dataVals=function(t,e){var a=e.split("."),l=a.shift();if(a.length)for(var n=0,o=a.length;n<o;n++)t=t[l]||{},l=a[n];return t[l]},String.prototype.capitalize=function(){return this.charAt(0).toUpperCase()+this.slice(1)},String.prototype.decodeUriParam=function(){return decodeURIComponent((this+"").replace(/\+/g,"%20"))},String.prototype.endsWithIndexOf=function(t){return-1!==this.indexOf(t,this.length-t.length)},"function"!=typeof Object.assign&&Object.defineProperty(Object,"assign",{writable:!0,configurable:!0,value:function(t){if(null==t)throw new TypeError("Cannot convert undefined or null to object");for(var e=Object(t),a=1;a<arguments.length;a++){var l=arguments[a];if(null!=l)for(var n in l)Object.prototype.hasOwnProperty.call(l,n)&&(e[n]=l[n])}return e}})}(jQuery);
